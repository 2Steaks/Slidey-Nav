!function(a,b,c,d){"use strict";function e(b,c){this.element=a(b),this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.is_dragging=!1,this.current_position=0,this.cursor_position=0,this.centered_item=!1,this.active=!0,this.is_centering=!0,this.list=this.element.children("ul"),this.items=this.list.children("li"),this.item_count=this.items.length,this.init()}var f="graphiteNav",g={disableGuides:!0,active_class:"active"};a.extend(e.prototype,{init:function(){var a=this;this.bindUIActions(),this.resizeOn(),setTimeout(function(){a.activeItem()},200)},bindUIActions:function(){this.element.on("mousewheel",a.proxy(this.onMouseScroll,this)),this.element.on("mousedown touchstart",a.proxy(this.onDragStart,this)),this.element.on("mousemove touchmove",a.proxy(this.onDrag,this)),this.element.on("mouseup mouseleave touchend",a.proxy(this.onDragEnd,this))},unBindUIActions:function(){this.element.off("mousedown mouseup mouseleave mousemove mousewheel touchstart touchend touchmove")},resizeOn:function(){var c=this.debounce(this.activeItem,200);a(b).on("resize",a.proxy(c,this))},resizeOff:function(){a(b).off("resize")},listTooSmall:function(){var a=!1;return this.getCombinedItemWidth()<this.element.outerWidth()?(a=!0,this.hideGuides(),this.element.addClass("is--inactive"),this.unBindUIActions()):(this.element.removeClass("is--inactive"),this.bindUIActions()),a},activeItem:function(){if(this.listTooSmall())return!1;var a=this.centered_item?this.centered_item:this.items.filter("."+this.settings.active_class);return 0===a.length?(("undefined"!=typeof console||"undefined"!=typeof console.warn)&&console.warn("Graphite Nav: Cannot find active list element, please check your class name matches."),this.centerNavFallback(),!1):void this.centerNav(a)},centerNav:function(a){var b=a.outerWidth()/2,c=a.position().left+b-this.element.outerWidth()/2,d=this.setLimits(c);TweenMax.to(this.list,0,{x:-d,onComplete:this.setGuides,onCompleteScope:this})},centerNavFallback:function(a){var b=this.element.width()/2,c=this.list.outerWidth()/2,d=c-b;TweenMax.to(this.list,0,{x:-d,onComplete:function(){a||this.setGuides()},onCompleteScope:this})},onMouseScroll:function(b){this.current_position=this.getMenuPosition();var c=this,d=b.originalEvent.deltaX,e=this.current_position-d,f=this.setLimits(-e);TweenMax.to(this.list,0,{x:-f}),this.current_position=f,b.preventDefault(),clearTimeout(a.data(this,"timer")),a.data(this,"timer",setTimeout(function(){c.onDragEnd()},250))},onDragStart:function(a){this.is_dragging=!0,this.current_position=this.getMenuPosition(),this.cursor_position=this.getDevicePositionX("mousedown"===a.type,a)},onDragEnd:function(a){this.dominantItem(a),this.is_dragging=!1},onDrag:function(a){return this.is_dragging===!1?!1:void this.drag(a)},drag:function(a){var b=this.getDevicePositionX("mousemove"===a.type,a),c=Math.abs(this.current_position)+this.cursor_position-b,d=this.setLimits(c);TweenMax.to(this.list,0,{x:-d})},setLimits:function(a){var b=this.element.outerWidth(),c=this.list.outerWidth(),d=c-b,e=1;return this.is_centering=!0,e>a?(a=0,this.is_centering=!1):a>d-e&&(a=d,this.is_centering=!1),a},dominantItem:function(b){if(!this.is_centering)return this.setGuides(),!1;var c,d=this.getMenuPosition()-this.element.outerWidth()/2,e=this.item_count-1,f=1;this.items.each(function(b,g){var h=a(g),i=h.position().left+h.outerWidth();return Math.abs(d)<=i?(c=h,!1):(b===e&&(c=h),void f++)}),this.centered_item=c,0!==f&&f!==this.item_count&&this.autoCentering(c,f)},autoCentering:function(a,b){var c=this.element.outerWidth(),d=c/2,e=a.outerWidth()/2,f=-a.position().left+d-e,g=this.list.outerWidth(),h=a.position().left+e,i=g-h,j=g-c;f>0?f=0:d>i&&(f=-j),TweenMax.to(this.list,.5,{x:f,ease:Power4.easeOut,onComplete:this.setGuides,onCompleteScope:this})},setGuides:function(){if(this.settings.disableGuides)return!1;var b=this.element.width(),c=Math.abs(this.getMenuPosition()),d={left:20,right:40},e={left:{active:!1,element:!1},right:{active:!1,element:!1}};this.items.each(function(f,g){var h=a(g),i=h.position().left+d.left,j=i+h.outerWidth()-c-d.right;c>i?(e.left.element=f,e.left.active=!0):j>b&&(e.right.element=f,e.right.active=!0)}),e.left.active?this.element.addClass("has--prev"):this.element.removeClass("has--prev"),e.right.active?this.element.addClass("has--next"):this.element.removeClass("has--next")},getCombinedItemWidth:function(){var b=0;return this.items.each(function(c,d){b+=a(d).outerWidth()}),b},showGuides:function(){this.element.addClass("has--prev"),this.element.addClass("has--next")},hideGuides:function(){this.element.removeClass("has--prev"),this.element.removeClass("has--next")},getMenuPosition:function(){return parseInt(this.list.css("transform").split(",")[4])},getDevicePositionX:function(a,b){return a?b.pageX:b.originalEvent.touches[0].pageX},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}}),a.fn.graphiteNav=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);